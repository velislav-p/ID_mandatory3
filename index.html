<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Travel app</title>
    <link type="text/css" rel="stylesheet" href="style/style.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:300,400,500,700,800" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous"></script>
</head>
<body>
<!-------------------- HEADER --------------------->
<div class="navbar">
    <ul>
        <li><button id="btn-nav-login" class="nav-button btn btn-success">Login</button></li>
        <li><button id="btn-nav-register" class="nav-button btn btn-success">Register</button></li>
        <li><button id='btn-logout' class='btn btn-success'>Logout</button></li>
    </ul>
</div>

<!------------------- SIDE BAR ------------------------->

<div class="sidebar search-form-empty">
        <span>From</span>
        <input class="lbl-from form-control" type="text">
        <span>To</span>
        <input class="lbl-to form-control" type="text">
        <span>Departure date</span>
        <input class="lbl-departure form-control" type="text">
        <span>Return date</span>
        <input class="lbl-return form-control" type="text">
        <span>One way</span>
        <input class="lbl-oneWay" name="trip" type="radio" value="One way">
        <span>Round trip</span>
        <input class="lbl-roundTrip" name="trip" type="radio" value="Round trip">
    <button class="btn-search-flight btn btn-warning">Search for flight</button>
</div>

<div class="sidebar search-form-full">
        <span>From</span>
        <span id="lbl-from"></span>
        <span>To</span>
        <span id="lbl-to"></span>
        <span>Departure date</span>
        <span id="lbl-departure"></span>
        <span>Return date</span>
        <span id="lbl-return"></span>
        <span id="lbl-trip-type"></span>
        <div id="flight-details"></div>
    <button id="btn-change-search-details" class="btn btn-warning">Change details</button>
</div>

<!------------------ MAIN ------------------------------->

<div class="main">

    <div id="wdw-search-results" class="wdw">
        <div class="flight">
            <div class="flight-date"><h5>Date</h5></div>
            <div class="flight-body">
                <span class="flight-departure-time">23.00</span>
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                <span class="flight-arrival-time">01.00</span>
            </div>
            <div class="flight-price">230 <span class="currency">DKK</span></div>
        </div>
        <div class="flight">
            <div class="flight-date"><h5>Date</h5></div>
            <div class="flight-body">
                <span class="flight-departure-time">23.00</span>
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                <span class="flight-arrival-time">01.00</span>
            </div>
            <div class="flight-price">230 <span class="currency">DKK</span></div>
        </div>
        <div class="flight">
            <div class="flight-date"><h5>Date</h5></div>
            <div class="flight-body">
                <span class="flight-departure-time">23.00</span>
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                <span class="flight-arrival-time">01.00</span>
            </div>
            <div class="flight-price">230 <span class="currency">DKK</span></div>
        </div>
        <div class="flight">
            <div class="flight-date"><h5>Date</h5></div>
            <div class="flight-body">
                <span class="flight-departure-time">23.00</span>
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
                <span class="flight-arrival-time">01.00</span>
            </div>
            <div class="flight-price">230 <span class="currency">DKK</span></div>
        </div>
    </div>
    <div id="wdw-register" class="wdw">
        <input type="text" id="field-register" class="form-control" placeholder="Please type in the account name you desire">
        <input type="password" id="field-password" class="form-control" placeholder="Type in desired password">
        <input type="submit" id="btn-registration" class="btn btn-warning" value="Register">
    </div>
    <div id="wdw-login" class="wdw">
        <input type="text" id="lbl-username" class="form-control" placeholder="username">
        <input type="text" id="lbl-password" class="form-control" placeholder="password">
        <input type="submit" id="btn-login" class="btn btn-warning" value="Log in">
        <div id="login-error-msg"></div>
    </div>
    <div id="wdw-profile" class="wdw">
        <span id="welcome-msg"></span>
    </div>
    <div class="wdw-payment wdw">
        <form>
            <div class="wdw-payment-InputArea">
                <label for="paymentName">Write your Name:</label>
                <input type="submit" id="btn-autofill" value="Autofill" >
                <input type="text" id="paymentName" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentsurname">Write your Surname:</label>
                <input type="text" id="paymentSurname" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentEmail">Write your E-mail here:</label>
                <input type="text" id="paymentEmail" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentCvr">Please type you company CVR here if available:</label>
                <input type="text" id="paymentCvr" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentCreditCardNumber">Enter your credit card number here:</label>
                <input type="text" id="paymentCreditCardNumber" class="form-control">
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentCreditCardDate">Enter your credit cards expiration date:</label>
                <input type="text" id="paymentCreditCardDate" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentCreditCardCVV">Enter the security number found on the back of your card:</label>
                <input type="text" id="paymentCreditCardCVV" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <label for="paymentAdress">In the field below type in your address:</label>
                <input type="text" id="paymentAdress" class="form-control" >
            </div>
            <div class="wdw-payment-InputArea">
                <input type="button" class="btn btn-warning" id="btn-submitPayment" value="Submit!">
            </div>
        </form>
    </div>
    <div class="wdw-receipt wdw" >
    </div>

</div>

<!------------------------JAVA---------------------->
<script>
//--------------- REGISTER ----------------------------------------------
    $("#btn-registration").click(function(){

    var fieldRegister = $("#field-register").val();
    var fieldPassword = $("#field-password").val();


    $.ajax({
        "url":"services/register.php",
        cache:false ,
        "method":"post",
        "dataType":"JSON",
        "data":  {"username":fieldRegister , "password": fieldPassword}
    }).done(function (jData) {

        displayProfile(jData);

    })
    });

    $("#btn-nav-login").click(function(){
        $(".wdw").css("display","none");
        $("#wdw-login").css("display","flex");
    });
    $("#btn-nav-register").click(function(){
        $(".wdw").css("display","none");
        $("#wdw-register").css("display","flex");
    });
//--------------- LOGIN ---------------------------------------------------
    $("#btn-login").click(function(){
        var username = $("#lbl-username").val();
        var password = $("#lbl-password").val();
        $.ajax({
            "url":"services/login.php",
            "method":"post",
            "data":{"username":username,"password":password},
            "dataType":"JSON",
            "cache":false
        }).done(function(jData){
            if(jData.status == "ok"){
                displayProfile(jData);
            }else{
                $("#login-error-msg").text("No such user found");
            }
        })
    });
//--------------- DISPLAY PROFILE ---------------------------------------------------
    function displayProfile(jData){
        $(".wdw").css("display","none");
        $("#wdw-profile").css("display","flex");
        $("#welcome-msg").text("Hello "+jData.username);
        $(".nav-button").css("display","none");
        $("#btn-logout").css("display","flex");
    }
//--------------- BUTTON CLICKS -----------------------------------------------------
    $("#btn-search-flight").click(function(){
        $("#wdw-search-results").css("display","flex");
    });

    $(document).on("click","#btn-logout",function(){
        $.ajax({
            "url":"services/logout.php",
            "method":"get"
        }).done(function(){
            $(".wdw").css("display","none");
            $("#wdw-offers").css("display","flex");
            $(".nav-button").css("display","flex");
            $("#btn-logout").css("display","none");
        })
    });
    $(".btn-search-flight").click(function() {
        var from = $(".lbl-from").val();
        var to = $(".lbl-to").val();
        var depDate = $(".lbl-departure").val();
        var arrDate = $(".lbl-return").val();
        var tripType = document.querySelector('input[name="trip"]:checked').value;

        $(".search-form-empty").css("display","none");
        $(".search-form-full").css("display","flex");
        $(".wdw").hide();
        $("#wdw-search-results").css("display","flex");
        $("#lbl-from").append(from);
        $("#lbl-to").append(to);
        $("#lbl-departure").append(depDate);
        $("#lbl-return").append(arrDate);
        $("#lbl-trip-type").append(tripType);
    });

    $(".flight").click(function(){
        var depTime = $(this).find('.flight-departure-time').text();
        var arrTime = $(this).find('.flight-arrival-time').text();
        var price = $(this).find('.flight-price').text();
        $("#flight-details").append("<div id='departureTime'>Departure time: <span>"+depTime+"</span></div>");
        $("#flight-details").append("<div id='arrivalTime'>Arrival time: <span>"+arrTime+"</span></div>");
        $("#flight-details").append("<div id='price'>Price: <span>"+price+"</span></div>");

        $(".wdw").hide();
        $(".wdw-payment").css("display","flex");
    });


//------------ PAYMENT ----------------------------------------------
    $("#btn-submitPayment").click(function () {

        var paymentName     = $("#paymentName").val();
        var paymentSurname  = $("#paymentSurname").val();
        var paymentCvr      = $("#paymentCvr").val();

        $(".wdw").hide();
        $(".wdw-receipt").css("display","flex").append("<div>"+paymentCvr+"</div><div>"+paymentSurname+"</div><div>"+paymentCvr+"</div>");


    });


</script>
</body>

</html>
